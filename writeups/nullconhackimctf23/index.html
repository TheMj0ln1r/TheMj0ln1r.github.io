<!doctype html><html lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><title>
         Nullcon Hackim CTF 2023
        
    </title><meta content="Nullcon Hackim CTF 2023" property=og:title><meta content="Known as TheMj0ln1r" property=og:description><meta content="Known as TheMj0ln1r" name=description><link href=/favicons/favicon.ico rel=icon type=image/png><link href=https://themj0ln1r.github.io/fonts.css rel=stylesheet><script src=https://themj0ln1r.github.io/js/codeblock.js></script><script src=https://themj0ln1r.github.io/js/toc.js></script><script src=https://themj0ln1r.github.io/js/note.js></script><script>MathJax={tex:{inlineMath:[[`\$`,`\$`],[`\\\\(`,`\\\\)`]]}}</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Charan Nomula" href=https://themj0ln1r.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://themj0ln1r.github.io/theme/light.css rel=stylesheet><link href=https://themj0ln1r.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://themj0ln1r.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme())</script><link href=https://themj0ln1r.github.io/main.css media=screen rel=stylesheet><body><div class=content><header><div class=main><a href=https://themj0ln1r.github.io/>Charan Nomula</a><div class=socials><a class=social href=https://x.com/TheMj0ln1r/ rel=me target=_blank> <img alt=twitter src=https://themj0ln1r.github.io/social_icons/twitter.svg> </a><a class=social href=https://linkedin.com/in/mj0ln1r/ rel=me target=_blank> <img alt=linkedin src=https://themj0ln1r.github.io/social_icons/linkedin.svg> </a><a class=social href=https://github.com/TheMj0ln1r/ rel=me target=_blank> <img alt=github src=https://themj0ln1r.github.io/social_icons/github.svg> </a><a href="mailto: playermj0ln1r@gmail.com" class=social rel=me target=_blank> <img alt=Email src=https://themj0ln1r.github.io/social_icons/email.svg> </a></div></div><nav><a href=https://themj0ln1r.github.io/posts style=margin-left:.5em>/posts</a><a href=https://themj0ln1r.github.io/writeups style=margin-left:.5em>/writeups</a><a href=https://themj0ln1r.github.io/projects style=margin-left:.5em>/projects</a><a href=https://themj0ln1r.github.io/contact style=margin-left:.5em>/contact</a><a href=https://themj0ln1r.github.io/tags style=margin-left:.5em>/tags</a> |<a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://themj0ln1r.github.io/feather/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://themj0ln1r.github.io/feather/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><main><article><div class=title><div class=page-header>Nullcon Hackim CTF 2023<span class=primary-color style=font-size:1.6em>.</span></div><div class=meta>Posted on <time>2023-08-20</time><span class=tags-label> :: Tags:</span><span class=tags> <a class=post-tag href=https://themj0ln1r.github.io/tags/ctf/>ctf</a> </span></div></div><div class=toc-container><h1 class=toc-title>Table of Contents</h1><ul class=toc-list><li><a href=https://themj0ln1r.github.io/writeups/nullconhackimctf23/#crypto-euclideanrsa>Crypto - EuclideanRSA</a><li><a href=https://themj0ln1r.github.io/writeups/nullconhackimctf23/#crypto-sebastian-s-secret-sharing>Crypto - Sebastian's Secret Sharing</a> <ul><li><a href=https://themj0ln1r.github.io/writeups/nullconhackimctf23/#shamir-secret-sharing>Shamir Secret Sharing</a></li><ul><li><a href=https://themj0ln1r.github.io/writeups/nullconhackimctf23/#step-1-choose-a-prime-number-and-parameters>Step 1: Choose a Prime Number and Parameters</a><li><a href=https://themj0ln1r.github.io/writeups/nullconhackimctf23/#step-2-define-the-polynomial>Step 2: Define the Polynomial</a><li><a href=https://themj0ln1r.github.io/writeups/nullconhackimctf23/#step-3-generate-shares>Step 3: Generate Shares</a><li><a href=https://themj0ln1r.github.io/writeups/nullconhackimctf23/#step-4-share-distribution>Step 4: Share Distribution</a><li><a href=https://themj0ln1r.github.io/writeups/nullconhackimctf23/#step-5-secret-reconstruction>Step 5: Secret Reconstruction</a></ul></ul></ul></div><section class=body><p>Long time no see? I have been learning things in Blockchain technology in last few months. Now everything at good pace hope I can solve more CTF's now. As comeback match, I solved this crypto challenge in <a href=https://ctftime.org/event/2065 target=_blank>NullCon HackIM CTF 2023</a> yesterday.<h1 id=crypto-euclideanrsa><a aria-label="Anchor link for: crypto-euclideanrsa" class=zola-anchor href=#crypto-euclideanrsa>Crypto - EuclideanRSA</a></h1><pre class=language-text data-lang=text style=color:#61676c;background-color:#fafafa><code class=language-text data-lang=text><span>Attached Files : [euclidean-RSA.py, output.txt]
</span></code></pre><p><code>euclidean-RSA.py</code><pre class=language-python data-lang=python style=color:#61676c;background-color:#fafafa><code class=language-python data-lang=python><span style=color:#abb0b6;font-style:italic>#!/usr/bin/env python3
</span><span style=color:#fa6e32>from </span><span>Crypto</span><span style=color:#ed9366>.</span><span>PublicKey </span><span style=color:#fa6e32>import </span><span>RSA
</span><span style=color:#fa6e32>from </span><span>Crypto</span><span style=color:#ed9366>.</span><span>Util</span><span style=color:#ed9366>.</span><span>number </span><span style=color:#fa6e32>import </span><span>bytes_to_long
</span><span style=color:#fa6e32>from </span><span>secret </span><span style=color:#fa6e32>import </span><span>flag</span><span style=color:#61676ccc>, </span><span>magic
</span><span>
</span><span style=color:#fa6e32>while </span><span style=color:#ff8f40>True</span><span>:
</span><span>	</span><span style=color:#fa6e32>try</span><span>:
</span><span>		key </span><span style=color:#ed9366>= </span><span>RSA</span><span style=color:#ed9366>.</span><span style=color:#f29718>generate</span><span>(</span><span style=color:#ff8f40>2048</span><span>)
</span><span>		a,b,c,d </span><span style=color:#ed9366>= </span><span style=color:#f29718>magic</span><span>(key)
</span><span>		</span><span style=color:#fa6e32>break
</span><span>	</span><span style=color:#fa6e32>except</span><span>:
</span><span>		</span><span style=color:#fa6e32>pass
</span><span style=color:#fa6e32>assert </span><span>a</span><span style=color:#ed9366>**</span><span style=color:#ff8f40>2 </span><span style=color:#ed9366>+ </span><span>b</span><span style=color:#ed9366>**</span><span style=color:#ff8f40>2 </span><span style=color:#ed9366>== </span><span>key</span><span style=color:#ed9366>.</span><span>n
</span><span style=color:#fa6e32>assert </span><span>c</span><span style=color:#ed9366>**</span><span style=color:#ff8f40>2 </span><span style=color:#ed9366>+ </span><span>d</span><span style=color:#ed9366>**</span><span style=color:#ff8f40>2 </span><span style=color:#ed9366>== </span><span>key</span><span style=color:#ed9366>.</span><span>n
</span><span style=color:#fa6e32>for </span><span style=color:#55b4d4;font-style:italic>_ </span><span style=color:#fa6e32>in </span><span>[a</span><span style=color:#61676ccc>,</span><span>b</span><span style=color:#61676ccc>,</span><span>c</span><span style=color:#61676ccc>,</span><span>d]:
</span><span>	</span><span style=color:#f07171>print</span><span>(</span><span style=color:#55b4d4;font-style:italic>_</span><span>)
</span><span>cipher </span><span style=color:#ed9366>= </span><span style=color:#f07171>pow</span><span>(</span><span style=color:#f29718>bytes_to_long</span><span>(flag)</span><span style=color:#61676ccc>, </span><span>key</span><span style=color:#ed9366>.</span><span>e</span><span style=color:#61676ccc>, </span><span>key</span><span style=color:#ed9366>.</span><span>n)
</span><span style=color:#f07171>print</span><span>(cipher)
</span><span>
</span></code></pre><p><code>output.txt</code><pre class=language-text data-lang=text style=color:#61676c;background-color:#fafafa><code class=language-text data-lang=text><span>139488614271687589953884690592970545345100917058745264617112217132329766542251923634602298183777415221556922931467521901793230800271771036880075840122128322419937786441619850848876309600263298041438727684373621920233326334840988865922273325440799379584418142760239470239003470212399313033715405566836809419407
</span><span>68334789534409058399709747444525414762334123566273125910569662060699644186162637240997793681284151882169786866201685085241431171760907057806355318216602175990235605823755224694383202043476486594392938995563562039702918509120988489287149220217082428193897933957628562633459049042920472531693730366503272507672
</span><span>124011822519139836919119491309637022805378274989854408578991029026928119002489232335977596528581855016599610031796540079373031282148998625318658034408770283112750172223328012238338715644743140990997114236125750813379366262418292349962679006556523851370694404238101553966330965676189731474108393418372330606063
</span><span>93529593432394381438671783119087013080855868893236377597950059020717371498802208966524066540234253992421963224344343067174201693672350438201011499762718490958025617655722916641293034417795512315497126128726644064013248230211347407788186320320456853993252621916838570027019607155835349111757703654306736031792
</span><span>2819638499688340337879314536945338371611392232636746056275506290935131270682791584873534866138393305591899169164183372576878693678187335219904407119253951099126339949954303448641761723704171837075206394491403411400326176280981393624784437102905397888236098861970020785226848615566768625581096019917060387964269283048823007992992874533775547300443032304973521568046956516203101626941042560505073773998143068621715480774707735064134961852206070850277695448391038882766344567740211926618750074636868149063283746597347807257171871016202588384726430246523650462866812935130465049824665395626882280287488078029119879891722
</span><span>
</span></code></pre><p>Observations :<ol><li>The modulus(n) is written as sum of two squares in two different ways<li>a,b,c,d values and ciphertext is given<li><code>e</code> is not given, probably <code>65537</code></ol><p>After searching about <code>sum of squares as modulus in RSA</code> I found this research paper https://www.mdpi.com/2297-8747/24/2/62<p>"""Consider a semi-prime number whose construction consists of primes $$ p1,p2, N = p1p2$$ , being Pythagorean,and having a representation on the Cartesian plane such that, $$p1 = x^2 + y^2$$. It can easily be shown that the product of two such primes can be represented as the sum of four squares from which two sums of two squares can be derived. For such a semi-prime, if the original construction is unknown and the sum of four squares is known, the original construction $$p1,p2$$ can be found."""<p>Lets look at <code>Eulers Factorization</code><ul><li><strong>A semi-prime whose prime factors are Pythagorean can be expressed as the sum of four squares, from which two sums of squares can be derived.</strong></ul><p>A semi-prime $$N = p1p2, p1 = a^2+b^2, p2 = c^2+d^2$$ is expressed as the sum of four squares, such that:<p>$$ N=p1p2=(a^2+b^2)(c^2+d^2)=(ac)^2+(bc)^2+(ad)^2+(bd)^2 $$<p>Now in our case, $$ N = (a^2+b^2)= (c^2+d^2)$$. We can solve for $$p1, p2$$ as follows.<p>$$ (a^2+b^2)= (c^2+d^2) $$<p>combining odds we get,<p>$$ (a^2-c^2)= (d^2-b^2) \ (a-c)(a+c) = (d-b)(d+b) \<p>p1 = \left(\frac{gcd(a-c,d-b)}{2}\right)^2 + \left(\frac{gcd(a+c,d+b)}{2}\right)^2\ p2 = \left(\frac{gcd(a+c,d-b)}{2}\right)^2 + \left(\frac{gcd(a-c,d+b)}{2}\right)^2\ $$<p>Enough math, lets implement this simple math in python<p><code>solve.py</code><pre class=language-python data-lang=python style=color:#61676c;background-color:#fafafa><code class=language-python data-lang=python><span style=color:#fa6e32>from </span><span>Crypto</span><span style=color:#ed9366>.</span><span>Util</span><span style=color:#ed9366>.</span><span>number </span><span style=color:#fa6e32>import </span><span>long_to_bytes
</span><span style=color:#fa6e32>from </span><span>sympy </span><span style=color:#fa6e32>import </span><span style=color:#ff8f40>*
</span><span style=color:#fa6e32>import </span><span>math
</span><span>a </span><span style=color:#ed9366>= </span><span style=color:#ff8f40>139488614271687589953884690592970545345100917058745264617112217132329766542251923634602298183777415221556922931467521901793230800271771036880075840122128322419937786441619850848876309600263298041438727684373621920233326334840988865922273325440799379584418142760239470239003470212399313033715405566836809419407
</span><span>b </span><span style=color:#ed9366>= </span><span style=color:#ff8f40>68334789534409058399709747444525414762334123566273125910569662060699644186162637240997793681284151882169786866201685085241431171760907057806355318216602175990235605823755224694383202043476486594392938995563562039702918509120988489287149220217082428193897933957628562633459049042920472531693730366503272507672
</span><span>c </span><span style=color:#ed9366>= </span><span style=color:#ff8f40>124011822519139836919119491309637022805378274989854408578991029026928119002489232335977596528581855016599610031796540079373031282148998625318658034408770283112750172223328012238338715644743140990997114236125750813379366262418292349962679006556523851370694404238101553966330965676189731474108393418372330606063
</span><span>d </span><span style=color:#ed9366>= </span><span style=color:#ff8f40>93529593432394381438671783119087013080855868893236377597950059020717371498802208966524066540234253992421963224344343067174201693672350438201011499762718490958025617655722916641293034417795512315497126128726644064013248230211347407788186320320456853993252621916838570027019607155835349111757703654306736031792
</span><span>cipher </span><span style=color:#ed9366>=</span><span style=color:#ff8f40>2819638499688340337879314536945338371611392232636746056275506290935131270682791584873534866138393305591899169164183372576878693678187335219904407119253951099126339949954303448641761723704171837075206394491403411400326176280981393624784437102905397888236098861970020785226848615566768625581096019917060387964269283048823007992992874533775547300443032304973521568046956516203101626941042560505073773998143068621715480774707735064134961852206070850277695448391038882766344567740211926618750074636868149063283746597347807257171871016202588384726430246523650462866812935130465049824665395626882280287488078029119879891722
</span><span>
</span><span>n </span><span style=color:#ed9366>= </span><span>(</span><span style=color:#f07171>pow</span><span>(a</span><span style=color:#61676ccc>,</span><span style=color:#ff8f40>2</span><span>)</span><span style=color:#ed9366>+</span><span style=color:#f07171>pow</span><span>(b</span><span style=color:#61676ccc>,</span><span style=color:#ff8f40>2</span><span>))
</span><span>
</span><span>g1 </span><span style=color:#ed9366>= </span><span style=color:#f29718>gcd</span><span>(a</span><span style=color:#ed9366>-</span><span>c</span><span style=color:#61676ccc>, </span><span>d</span><span style=color:#ed9366>-</span><span>b)</span><span style=color:#ed9366>/</span><span style=color:#ff8f40>2 
</span><span>g2 </span><span style=color:#ed9366>= </span><span style=color:#f29718>gcd</span><span>(a</span><span style=color:#ed9366>+</span><span>c</span><span style=color:#61676ccc>, </span><span>d</span><span style=color:#ed9366>+</span><span>b)</span><span style=color:#ed9366>/</span><span style=color:#ff8f40>2 
</span><span>
</span><span>p </span><span style=color:#ed9366>= </span><span>g1</span><span style=color:#ed9366>*</span><span>g1 </span><span style=color:#ed9366>+ </span><span>g2</span><span style=color:#ed9366>*</span><span>g2
</span><span>
</span><span>g1 </span><span style=color:#ed9366>= </span><span style=color:#f29718>gcd</span><span>(a</span><span style=color:#ed9366>+</span><span>c</span><span style=color:#61676ccc>, </span><span>d</span><span style=color:#ed9366>-</span><span>b)</span><span style=color:#ed9366>/</span><span style=color:#ff8f40>2 
</span><span>g2 </span><span style=color:#ed9366>= </span><span style=color:#f29718>gcd</span><span>(a</span><span style=color:#ed9366>-</span><span>c</span><span style=color:#61676ccc>, </span><span>d</span><span style=color:#ed9366>+</span><span>b)</span><span style=color:#ed9366>/</span><span style=color:#ff8f40>2 
</span><span>
</span><span>q </span><span style=color:#ed9366>= </span><span>g1</span><span style=color:#ed9366>*</span><span>g1 </span><span style=color:#ed9366>+ </span><span>g2</span><span style=color:#ed9366>*</span><span>g2
</span><span>
</span><span>phi </span><span style=color:#ed9366>= </span><span>(p</span><span style=color:#ed9366>-</span><span style=color:#ff8f40>1</span><span>)</span><span style=color:#ed9366>*</span><span>(q</span><span style=color:#ed9366>-</span><span style=color:#ff8f40>1</span><span>)
</span><span style=color:#f07171>print</span><span>(phi)
</span><span>d </span><span style=color:#ed9366>= </span><span style=color:#f07171>pow</span><span>(</span><span style=color:#ff8f40>65537</span><span style=color:#61676ccc>,</span><span style=color:#ed9366>-</span><span style=color:#ff8f40>1</span><span style=color:#61676ccc>,</span><span style=color:#55b4d4;font-style:italic>int</span><span>(phi))
</span><span>plaintext </span><span style=color:#ed9366>= </span><span style=color:#f29718>long_to_bytes</span><span>(</span><span style=color:#f07171>pow</span><span>(cipher</span><span style=color:#61676ccc>, </span><span>d</span><span style=color:#61676ccc>, </span><span>n))
</span><span>
</span><span style=color:#f07171>print</span><span>(</span><span style=color:#86b300>"Decrypted plaintext:"</span><span style=color:#61676ccc>, </span><span>plaintext)
</span><span>
</span><span style=color:#abb0b6;font-style:italic># Output
</span><span style=color:#abb0b6;font-style:italic># Decrypted plaintext: b'ENO{Gauss_t0ld_u5_th3r3_1s_mor3_th4n_on3_d1men5i0n}'
</span></code></pre><h1 id=crypto-sebastian-s-secret-sharing><a aria-label="Anchor link for: crypto-sebastian-s-secret-sharing" class=zola-anchor href=#crypto-sebastian-s-secret-sharing>Crypto - Sebastian's Secret Sharing</a></h1><pre class=language-text data-lang=text style=color:#61676c;background-color:#fafafa><code class=language-text data-lang=text><span>Attached files : [sss.py]
</span></code></pre><pre class=language-python data-lang=python style=color:#61676c;background-color:#fafafa><code class=language-python data-lang=python><span style=color:#abb0b6;font-style:italic>#!/usr/bin/env python3
</span><span style=color:#fa6e32>import </span><span>random
</span><span style=color:#fa6e32>from </span><span>decimal </span><span style=color:#fa6e32>import </span><span>Decimal</span><span style=color:#61676ccc>,</span><span>getcontext
</span><span>
</span><span style=color:#fa6e32>class </span><span style=color:#399ee6>SeSeSe</span><span>:
</span><span>	</span><span style=color:#fa6e32>def </span><span style=color:#f07171>__init__</span><span>(</span><span style=color:#ff8f40>self</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>s</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>n</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>t</span><span>):
</span><span>		</span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>s </span><span style=color:#ed9366>= </span><span style=color:#55b4d4;font-style:italic>int</span><span style=color:#ed9366>.</span><span style=color:#f29718>from_bytes</span><span>(s</span><span style=color:#ed9366>.</span><span style=color:#f29718>encode</span><span>()</span><span style=color:#61676ccc>,</span><span style=color:#ff8f40>byteorder</span><span style=color:#ed9366>=</span><span style=color:#86b300>"big"</span><span>)
</span><span>		</span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>l </span><span style=color:#ed9366>= </span><span style=color:#f07171>len</span><span>(s) 	
</span><span>		</span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>n </span><span style=color:#ed9366>= </span><span>n
</span><span>		</span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>t </span><span style=color:#ed9366>= </span><span>t
</span><span>		</span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>a </span><span style=color:#ed9366>= </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span style=color:#f29718>_a</span><span>()
</span><span>
</span><span>	</span><span style=color:#fa6e32>def </span><span style=color:#f29718>_a</span><span>(</span><span style=color:#ff8f40>self</span><span>):
</span><span>		c </span><span style=color:#ed9366>= </span><span>[</span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>s]
</span><span>		</span><span style=color:#fa6e32>for </span><span>i </span><span style=color:#fa6e32>in </span><span style=color:#f07171>range</span><span>(</span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>t</span><span style=color:#ed9366>-</span><span style=color:#ff8f40>1</span><span>):
</span><span>			a </span><span style=color:#ed9366>= </span><span style=color:#f29718>Decimal</span><span>(random</span><span style=color:#ed9366>.</span><span style=color:#f29718>randint</span><span>(</span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>s</span><span style=color:#ed9366>+</span><span style=color:#ff8f40>1</span><span style=color:#61676ccc>, </span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>s</span><span style=color:#ed9366>*</span><span style=color:#ff8f40>2</span><span>))
</span><span>			c</span><span style=color:#ed9366>.</span><span style=color:#f29718>append</span><span>(a)
</span><span>		</span><span style=color:#fa6e32>return </span><span>c
</span><span>
</span><span>	</span><span style=color:#fa6e32>def </span><span style=color:#f29718>encode</span><span>(</span><span style=color:#ff8f40>self</span><span>):
</span><span>		s </span><span style=color:#ed9366>= </span><span>[]
</span><span>		</span><span style=color:#fa6e32>for </span><span>j </span><span style=color:#fa6e32>in </span><span style=color:#f07171>range</span><span>(</span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>n):
</span><span>			x </span><span style=color:#ed9366>= </span><span>j
</span><span>			px </span><span style=color:#ed9366>= </span><span style=color:#f07171>sum</span><span>([</span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>a[i] </span><span style=color:#ed9366>* </span><span>x</span><span style=color:#ed9366>**</span><span>i </span><span style=color:#fa6e32>for </span><span>i </span><span style=color:#fa6e32>in </span><span style=color:#f07171>range</span><span>(</span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>t)]) 
</span><span>			s</span><span style=color:#ed9366>.</span><span style=color:#f29718>append</span><span>((x</span><span style=color:#61676ccc>,</span><span>px))
</span><span>		</span><span style=color:#fa6e32>return </span><span>s
</span><span>
</span><span>	</span><span style=color:#fa6e32>def </span><span style=color:#f29718>decode</span><span>(</span><span style=color:#ff8f40>self</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>shares</span><span>):
</span><span>		</span><span style=color:#fa6e32>assert </span><span style=color:#f07171>len</span><span>(shares)</span><span style=color:#ed9366>==</span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>t
</span><span>		secret </span><span style=color:#ed9366>= </span><span style=color:#f29718>Decimal</span><span>(</span><span style=color:#ff8f40>0</span><span>)
</span><span>		</span><span style=color:#fa6e32>for </span><span>j </span><span style=color:#fa6e32>in </span><span style=color:#f07171>range</span><span>(</span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>t):
</span><span>			yj </span><span style=color:#ed9366>= </span><span style=color:#f29718>Decimal</span><span>(shares[j][</span><span style=color:#ff8f40>1</span><span>])
</span><span>			r </span><span style=color:#ed9366>= </span><span style=color:#f29718>Decimal</span><span>(</span><span style=color:#ff8f40>1</span><span>)
</span><span>			</span><span style=color:#fa6e32>for </span><span>m </span><span style=color:#fa6e32>in </span><span style=color:#f07171>range</span><span>(</span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>t):
</span><span>				</span><span style=color:#fa6e32>if </span><span>m </span><span style=color:#ed9366>== </span><span>j:
</span><span>					</span><span style=color:#fa6e32>continue
</span><span>				xm </span><span style=color:#ed9366>= </span><span style=color:#f29718>Decimal</span><span>(shares[m][</span><span style=color:#ff8f40>0</span><span>])
</span><span>				xj </span><span style=color:#ed9366>= </span><span style=color:#f29718>Decimal</span><span>(shares[j][</span><span style=color:#ff8f40>0</span><span>])
</span><span>
</span><span>				r </span><span style=color:#ed9366>*= </span><span style=color:#f29718>Decimal</span><span>(xm</span><span style=color:#ed9366>/</span><span style=color:#f29718>Decimal</span><span>(xm</span><span style=color:#ed9366>-</span><span>xj))
</span><span>			secret </span><span style=color:#ed9366>+= </span><span style=color:#f29718>Decimal</span><span>(yj </span><span style=color:#ed9366>* </span><span>r)
</span><span>		</span><span style=color:#fa6e32>return </span><span style=color:#55b4d4;font-style:italic>int</span><span>(</span><span style=color:#f07171>round</span><span>(</span><span style=color:#f29718>Decimal</span><span>(secret)</span><span style=color:#61676ccc>,</span><span style=color:#ff8f40>0</span><span>))</span><span style=color:#ed9366>.</span><span style=color:#f29718>to_bytes</span><span>(</span><span style=color:#55b4d4;font-style:italic>self</span><span style=color:#ed9366>.</span><span>l)</span><span style=color:#ed9366>.</span><span style=color:#f29718>decode</span><span>()
</span><span>
</span><span>
</span><span style=color:#fa6e32>if </span><span>__name__ </span><span style=color:#ed9366>== </span><span style=color:#86b300>"__main__"</span><span>:
</span><span>	</span><span style=color:#f29718>getcontext</span><span>()</span><span style=color:#ed9366>.</span><span>prec </span><span style=color:#ed9366>= </span><span style=color:#ff8f40>256 </span><span style=color:#abb0b6;font-style:italic># beat devision with precision :D 
</span><span>	n </span><span style=color:#ed9366>= </span><span>random</span><span style=color:#ed9366>.</span><span style=color:#f29718>randint</span><span>(</span><span style=color:#ff8f40>50</span><span style=color:#61676ccc>,</span><span style=color:#ff8f40>150</span><span>)
</span><span>	t </span><span style=color:#ed9366>= </span><span>random</span><span style=color:#ed9366>.</span><span style=color:#f29718>randint</span><span>(</span><span style=color:#ff8f40>5</span><span style=color:#61676ccc>,</span><span style=color:#ff8f40>10</span><span>)
</span><span>	sss </span><span style=color:#ed9366>= </span><span style=color:#f29718>SeSeSe</span><span>(</span><span style=color:#ff8f40>s</span><span style=color:#ed9366>=</span><span style=color:#f07171>open</span><span>(</span><span style=color:#86b300>"flag.txt"</span><span style=color:#61676ccc>,</span><span style=color:#86b300>'r'</span><span>)</span><span style=color:#ed9366>.</span><span style=color:#f29718>read</span><span>()</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>n</span><span style=color:#ed9366>=</span><span>n</span><span style=color:#61676ccc>, </span><span style=color:#ff8f40>t</span><span style=color:#ed9366>=</span><span>t)
</span><span>	
</span><span>	shares </span><span style=color:#ed9366>= </span><span>sss</span><span style=color:#ed9366>.</span><span style=color:#f29718>encode</span><span>()
</span><span>
</span><span>	</span><span style=color:#f07171>print</span><span>(</span><span style=color:#fa6e32>f</span><span style=color:#86b300>"Welcome to Sebastian's Secret Sharing!"</span><span>)
</span><span>	</span><span style=color:#f07171>print</span><span>(</span><span style=color:#fa6e32>f</span><span style=color:#86b300>"I have split my secret into 1..N=</span><span>{sss</span><span style=color:#ed9366>.</span><span>n}</span><span style=color:#86b300> shares, and you need t=</span><span>{sss</span><span style=color:#ed9366>.</span><span>t}</span><span style=color:#86b300> shares to recover it."</span><span>)
</span><span>	</span><span style=color:#f07171>print</span><span>(</span><span style=color:#fa6e32>f</span><span style=color:#86b300>"However, I will only give you </span><span>{sss</span><span style=color:#ed9366>.</span><span>t</span><span style=color:#ed9366>-</span><span style=color:#ff8f40>1</span><span>}</span><span style=color:#86b300> shares :P"</span><span>)
</span><span>	</span><span style=color:#fa6e32>for </span><span>i </span><span style=color:#fa6e32>in </span><span style=color:#f07171>range</span><span>(</span><span style=color:#ff8f40>1</span><span style=color:#61676ccc>,</span><span>sss</span><span style=color:#ed9366>.</span><span>t):
</span><span>		</span><span style=color:#fa6e32>try</span><span>:
</span><span>			sid </span><span style=color:#ed9366>= </span><span style=color:#55b4d4;font-style:italic>int</span><span>(</span><span style=color:#f07171>input</span><span>(</span><span style=color:#fa6e32>f</span><span style=color:#86b300>"</span><span>{i}</span><span style=color:#86b300>.: Choose a share: "</span><span>))
</span><span>			</span><span style=color:#fa6e32>if </span><span style=color:#ff8f40>1 </span><span style=color:#ed9366><= </span><span>sid </span><span style=color:#ed9366><= </span><span>sss</span><span style=color:#ed9366>.</span><span>n:
</span><span>				</span><span style=color:#f07171>print</span><span>(shares[sid </span><span style=color:#ed9366>% </span><span>sss</span><span style=color:#ed9366>.</span><span>n])
</span><span>		</span><span style=color:#fa6e32>except</span><span>:
</span><span>			</span><span style=color:#fa6e32>pass
</span><span>	</span><span style=color:#f07171>print</span><span>(</span><span style=color:#86b300>"Good luck!"</span><span>)
</span></code></pre><p>The remote connection of chalenge gives us the following information.<pre class=language-sh data-lang=sh style=color:#61676c;background-color:#fafafa><code class=language-sh data-lang=sh><span style=color:#f29718>mj0ln1r@Linux:</span><span style=color:#55b4d4;font-style:italic>~</span><span style=color:#f29718>/</span><span> nc 52.59.124.14 10031
</span><span style=color:#f29718>Welcome</span><span> to Sebastian</span><span style=color:#86b300>'s Secret Sharing!
</span><span style=color:#86b300>I have split my secret into 1..N=83 shares, and you need t=10 shares to recover it.
</span><span style=color:#86b300>However, I will only give you 9 shares :P
</span><span style=color:#86b300>1.: Choose a share: 
</span></code></pre><p>I searched about secret sharing schemes available, and found that this challenge is related to <a href=https://en.wikipedia.org/wiki/Shamir%27s_secret_sharing target=_blank>Shamir Secret Sharing</a>. I used trailofbits <a href=https://www.zkdocs.com/docs/zkdocs/protocol-primitives/shamir/ target=_blank>ZKdocs</a>to learn weaknesses in Shamir Secret Sharing.<h3 id=shamir-secret-sharing><a aria-label="Anchor link for: shamir-secret-sharing" class=zola-anchor href=#shamir-secret-sharing>Shamir Secret Sharing</a></h3><p>Shamir's Secret Sharing is a cryptographic algorithm that allows you to split a secret into multiple shares in such a way that a minimum threshold of these shares is required to reconstruct the original secret. The algorithm was developed by Adi Shamir in 1979.<h4 id=step-1-choose-a-prime-number-and-parameters><a aria-label="Anchor link for: step-1-choose-a-prime-number-and-parameters" class=zola-anchor href=#step-1-choose-a-prime-number-and-parameters>Step 1: Choose a Prime Number and Parameters</a></h4><ol><li>Choose a large prime number $$p$$ such that $$p > \text{max_secret_value}$$, where $$\text{max_secret_value}$$ is the maximum possible value of the secret you want to share.<li>Choose a threshold value $$ (k) $$, which represents the minimum number of shares required to reconstruct the secret.<li>Choose $$(k-1)$$ random coefficients $$(a_1, a_2, \ldots, a_{k-1})$$ from the finite field $$(\mathbb{F}_p)$$.</ol><h4 id=step-2-define-the-polynomial><a aria-label="Anchor link for: step-2-define-the-polynomial" class=zola-anchor href=#step-2-define-the-polynomial>Step 2: Define the Polynomial</a></h4><ol start=4><li><p>Construct a polynomial of degree $$(k-1)$$ over $$(\mathbb{F}_p)$$ using the chosen coefficients:</p> <p>$$ f(x) = a_1x^{k-1} + a_2x^{k-2} + \ldots + a_{k-1}x + \text{secret}\ $$</p> <p>Where:</p> <ul><li>$$(a_1, a_2, \ldots, a_{k-1})$$ are the randomly chosen coefficients.<li>$$(\text{secret})$$ is the value you want to share.</ul></ol><h4 id=step-3-generate-shares><a aria-label="Anchor link for: step-3-generate-shares" class=zola-anchor href=#step-3-generate-shares>Step 3: Generate Shares</a></h4><ol start=5><li><p>Choose $$(k)$$ distinct x-values $$(x_1, x_2, \ldots, x_k)$$ from the field $$(\mathbb{F}_p)$$.</p><li><p>Compute $$(y_i = f(x_i))$$ for each $$(i)$$, which represents the shares:</p> <p>$$ y_i = a_1x_i^{k-1} + a_2x_i^{k-2} + \ldots + a_{k-1}x_i + \text{secret} $$</p> <p>These $$k$$ pairs $$((x_i, y_i))$$ are the shares that can be distributed among participants.</p></ol><h4 id=step-4-share-distribution><a aria-label="Anchor link for: step-4-share-distribution" class=zola-anchor href=#step-4-share-distribution>Step 4: Share Distribution</a></h4><ol start=7><li>Distribute the shares $$((x_i, y_i))$$ to the participants. Each participant receives one share.</ol><h4 id=step-5-secret-reconstruction><a aria-label="Anchor link for: step-5-secret-reconstruction" class=zola-anchor href=#step-5-secret-reconstruction>Step 5: Secret Reconstruction</a></h4><ol start=8><li><p>To reconstruct the secret, you need at least $$(k)$$ shares. Let's say you have $$(k)$$ shares $$((x_1, y_1), (x_2, y_2), \ldots, (x_k, y_k))$$</p><li><p>Use Lagrange interpolation to find the value of the secret:</p> <p>$$ \text{secret} = \sum_{i=1}^{k} y_i \cdot \frac{\prod_{j=1, j\neq i}^{k} (x - x_j)}{\prod_{j=1, j\neq i}^{k} (x_i - x_j)} $$</p> <p>Where:</p> <ul><li>$$(y_i)$$ are the y-values of the shares.<li>$$(x_i)$$ are the x-values of the shares.<li>$$(x)$$ is the variable (typically set to 0).</ul></ol><p>By calculating this equation, you can reconstruct the original secret.<p>This is how <code>Shamir Secret Sharing</code> cryptosystem works. Coming to Challenge, we are able to get the $$(k-1)$$ shares of secret, but we need exactly $$k$$ shares to reconstruct the secret. The secret is nothing but the $$0^{th}$$ share ((0,S_0)).<p>I was not able to find the flaw in system during the CTF, after the CTF <strong><code>hakid29</code></strong> on discord helped me to find the flaw, that is, sending <code>n</code> will give us the $$0^{th}$$ share which is the actual secret.<p><strong>Why sending n..?</strong><p>If we observer the following line in code,<pre class=language-python data-lang=python style=color:#61676c;background-color:#fafafa><code class=language-python data-lang=python><span>sid </span><span style=color:#ed9366>= </span><span style=color:#55b4d4;font-style:italic>int</span><span>(</span><span style=color:#f07171>input</span><span>(</span><span style=color:#fa6e32>f</span><span style=color:#86b300>"</span><span>{i}</span><span style=color:#86b300>.: Choose a share: "</span><span>))
</span><span style=color:#fa6e32>if </span><span style=color:#ff8f40>1 </span><span style=color:#ed9366><= </span><span>sid </span><span style=color:#ed9366><= </span><span>sss</span><span style=color:#ed9366>.</span><span>n:
</span><span>	</span><span style=color:#f07171>print</span><span>(shares[sid </span><span style=color:#ed9366>% </span><span>sss</span><span style=color:#ed9366>.</span><span>n])
</span></code></pre><p>we can know that this allows us to input the any number from (1 to n) including both. So in the below line simple $$%$$ operator is used to select the share among all shares. If we send <code>n</code> then it will become $$n mod n = 0$$, so it will select the $$0^{th}$$ share which is the flag we need.<pre class=language-sh data-lang=sh style=color:#61676c;background-color:#fafafa><code class=language-sh data-lang=sh><span style=color:#f29718>mj0ln1r@Linux:</span><span style=color:#55b4d4;font-style:italic>~</span><span style=color:#f29718>$</span><span> nc 52.59.124.14 10031
</span><span style=color:#f29718>Welcome</span><span> to Sebastian</span><span style=color:#86b300>'s Secret Sharing!
</span><span style=color:#86b300>I have split my secret into 1..N=141 shares, and you need t=5 shares to recover it.
</span><span style=color:#86b300>However, I will only give you 4 shares :P
</span><span style=color:#86b300>1.: Choose a share: 141
</span><span style=color:#86b300>(0, Decimal('</span><span>111370287875855598506538509804271500535681803123044982950094717</span><span style=color:#86b300>'))
</span><span style=color:#86b300>2.: Choose a share: 
</span><span style=color:#86b300>^C
</span></code></pre><pre class=language-python data-lang=python style=color:#61676c;background-color:#fafafa><code class=language-python data-lang=python><span style=color:#fa6e32>from </span><span>Crypto</span><span style=color:#ed9366>.</span><span>Util</span><span style=color:#ed9366>.</span><span>number </span><span style=color:#fa6e32>import </span><span style=color:#ff8f40>*
</span><span style=color:#f07171>print</span><span>(</span><span style=color:#f29718>long_to_bytes</span><span>(</span><span style=color:#ff8f40>111370287875855598506538509804271500535681803123044982950094717</span><span>))
</span><span>
</span><span style=color:#abb0b6;font-style:italic># output
</span><span style=color:#abb0b6;font-style:italic># b'ENO{SeCr3t_Sh4m1r_H4sh1ng}
</span></code></pre><blockquote><p>I solved an easy web challenge too, look at this <a href=https://xhacka.github.io/posts/writeup/2023/08/20/TYPicalBoss/ target=_blank>blog</a> someone explained it better.</blockquote><hr><p>Thank you for reading!</section></article></main></div>